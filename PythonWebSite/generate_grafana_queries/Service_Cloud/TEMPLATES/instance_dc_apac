    DOWNSAMPLE(
      SCALE(
        GROUPBYTAG(
          FILL(
            GROUPBYTAG(
              CULL_BELOW(
                FILL(
                  GROUPBYTAG(
                    GROUPBYTAG(
                      CULL_BELOW(
                        EXCLUDE(
                          PROPAGATE(
                            $start:$end:synthetics.*.AGG.all:AVAILABILITY_METRIC_NAME{operationalStatus=ACTIVE,dataCenterName=$APAC,substrate=SFDC_CORE,podName=*,level=testCase,testCaseId=TESTCASEID}:max:10m-max,#10m#
                          ),
                          #(.*podName=$EXCLUDELIST.*)#
                        ),
                        #-0.5#,#value#
                      ),
                      #testCaseId#,#podName#,#COUNT#
                    ),
                    GROUPBYTAG(
                      EXCLUDE(
                        PROPAGATE(
                          $start:$end:synthetics.*.AGG.all:AVAILABILITY_METRIC_NAME{operationalStatus=ACTIVE,dataCenterName=$APAC,substrate=SFDC_CORE,podName=*,level=testCase,testCaseId=TESTCASEID}:max:10m-max,#10m#
                        ),
                        #(.*podName=$EXCLUDELIST.*)#
                      ),
                      #testCaseId#,#podName#,#COUNT#
                    ),
                    #testCaseId#,#podName#,#DIVIDE#,#UNION#,#0#
                  ),
                  #10m#,#0m#,#1#
                ),
                #0.01#,#value#
              ),
              #testCaseId#,#podName#,#COUNT#
            ),
            #10m#,#0m#,#0#
          ),
          #dataCenterName#,#AVERAGE#
        ),
        #100#
      ),
      #all-avg#
    )
