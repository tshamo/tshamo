,
  DOWNSAMPLE(
    SCALE(
      GROUPBYTAG(
        FILL(
          GROUPBYTAG(
            CULL_BELOW(
              FILL(
                GROUPBYTAG(
                  GROUPBYTAG(
                    CULL_BELOW(
                      EXCLUDE(INCLUDE(
                        PROPAGATE(
                          $start:$end:synthetics.*.AGG.all:AVAILABILITY_METRIC_NAME{dataCenterName=*,substrate=AWS,podName=*,level=testCase,testCaseId=TESTCASEID}:max:10m-max,#10m#
                        ),
                        #(.*podName=.*s,.*)#),#(.*podName=$EXCLUDELISTHFSB.*)#
                      ),
                      #-0.5#,#value#
                    ),
                    #podName#,#COUNT#
                  ),
                  GROUPBYTAG(
                    EXCLUDE(INCLUDE(
                      PROPAGATE(
                        $start:$end:synthetics.*.AGG.all:AVAILABILITY_METRIC_NAME{dataCenterName=*,substrate=AWS,podName=*,level=testCase,testCaseId=TESTCASEID}:max:10m-max,#10m#
                      ),
                      #(.*podName=.*s,.*)#),#(.*podName=$EXCLUDELISTHFSB.*)#
                    ),
                    #podName#,#COUNT#
                  ),
                  #podName#,#DIVIDE#,#UNION#,#0#
                ),
                #10m#,#0m#,#1#
              ),
              #0.01#,#value#
            ),
            #podName#,#COUNT#
          ),
          #10m#,#0m#,#0#
        ),
        #podName#,#AVERAGE#
      ),
      #100#
    ),
    #all-avg#
  )
